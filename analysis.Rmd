---
title: "Detailed Analysis - Jargon User Analytics"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
    css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(plotly)
library(DT)
```

```{=html}
<div class="nav-header">
  <div class="nav-title">Jargon Analytics</div>
  <div class="nav-links">
    <a href="index.html" class="nav-inactive">Overview</a>
    <a href="analysis.html" class="nav-active">Detailed Analysis</a>
  </div>
</div>
```

This page provides an in-depth analysis of user engagement patterns with the Jargon Chrome extension. 


```{r data-prep}
# Load and prepare data
profiles <- read_csv("data/profiles_rows_cleaned.csv")
questions <- read_csv("data/questions_rows.csv")
words <- read_csv("data/words_rows.csv")
levels <- read_csv("data/levels_rows.csv")
websites <- read_csv("data/website_blacklist_rows.csv")

# Enhance profiles data
question_counts <- questions %>%
  group_by(user_id) %>%
  summarise(generated_questions = n())

answer_counts <- words %>%
  group_by(user_id) %>%
  summarise(answered_questions = n())

blocked_websites <- websites %>%
  group_by(user_id) %>%
  summarise(blocked_sites = n())

distinct_levels <- levels %>%
  group_by(user_id) %>%
  summarise(levels_attempted = n_distinct(level))

# Merge enhanced data
enhanced_profiles <- profiles %>%
  left_join(question_counts, by = "user_id") %>%
  mutate(generated_questions = ifelse(is.na(generated_questions), 0, generated_questions)) %>%
  left_join(answer_counts, by = "user_id") %>%
  mutate(answered_questions = ifelse(is.na(answered_questions), 0, answered_questions)) %>%
  left_join(blocked_websites, by = "user_id") %>%
  mutate(blocked_sites = ifelse(is.na(blocked_sites), 0, blocked_sites)) %>%
  left_join(distinct_levels, by = "user_id") %>%
  mutate(levels_attempted = ifelse(is.na(levels_attempted), 0, levels_attempted)) %>%
  mutate(highlightStyle = if_else(highlightStyle == "highlight", 1, 0))
```

## Language Learning Patterns

```{r language-patterns}
# Process language data
language_data <- questions %>%
  count(language) %>%
  arrange(desc(n))  # Sort data by count in descending order

# Create interactive bar chart
plot_ly(language_data,
        x = ~reorder(language, n),  # Reorder x-axis based on count
        y = ~n,
        type = "bar",
        marker = list(color = "#6a0dad")) %>%
  layout(
    title = list(
      text = "<span class='content-title'>Figure 1: Questions Generated by Language Category</span>",
      x = 0.5,
      y = 1,
      pad = list(t = 20, b = 0)
    ),
    xaxis = list(
      title = "Language", 
      tickangle = 45,
      categoryorder = "array",  # Use the explicit order we defined
      categoryarray = language_data$language  # Use our sorted order
    ),
    yaxis = list(title = "Number of Questions"),
    hovermode = "closest",
    margin = list(t = 40, r = 10, l = 10, b = 10)
  )
```

**Figure 1 Description**: This bar chart shows the distribution of questions generated across different language categories. Spanish leads in question generation, followed by GlizzyTalk and Tamil, indicating these are the most popular learning categories among users. The variation in question counts suggests different levels of engagement across language options, which could inform future content development priorities.

## Temporal Usage Patterns

```{r activity-timeline}
# Process timeline data
timeline_data <- questions %>%
  mutate(created_at = as.POSIXct(created_at, format = "%Y-%m-%d %H:%M:%OS", tz = "UTC")) %>%
  mutate(date = as.Date(created_at)) %>%
  group_by(date) %>%
  summarise(number_of_questions = n())

# Create interactive time series
plot_ly(timeline_data,
        x = ~date,
        y = ~number_of_questions,
        type = "scatter",
        mode = "lines+markers",
        line = list(color = "#d5c5e8"),
        marker = list(color = "#6a0dad")) %>%
  layout(
    title = list(
      text = "<span class='content-title'>Figure 2: Daily Question Generation Activity</span>",
      x = 0.5,
      y = 1,
      pad = list(t = 20, b = 0)
    ),
    xaxis = list(title = "Date"),
    yaxis = list(title = "Number of Questions"),
    hovermode = "closest",
    margin = list(t = 40, r = 10, l = 10, b = 10)
  )
```

**Figure 2 Description**: The time series plot reveals the daily pattern of question generation over time. Notable spikes in activity occur periodically, particularly around October, suggesting possible promotional events or user engagement initiatives. The baseline activity shows consistent but relatively low engagement, indicating opportunities for improving regular user participation.
