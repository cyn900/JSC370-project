---
title: "Detailed Analysis - Jargon User Analytics"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
    css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(plotly)
library(DT)
```

```{=html}
<div class="nav-header">
  <div class="nav-title">Jargon Analytics</div>
  <div class="nav-links">
    <a href="index.html" class="nav-inactive">Home</a>
    <a href="data_overview.html" class="nav-active">Data Overview</a>
    <a href="eda.html" class="nav-inactive">EDA</a>
    <a href="methods.html" class="nav-inactive">Methods</a>
    <a href="results.html" class="nav-inactive">Results</a>
    <a href="conclusions.html" class="nav-inactive">Conclusions</a>
  </div>
</div>
```

[Back to Overview](index.html) | [Conclusions](conclusions.html)

# Detailed Analysis - Jargon User Analytics

This page provides an in-depth analysis of user engagement patterns with the Jargon Chrome extension, strictly following the structure and content of the final report. All plots are interactive and presented in the same order as the report.

## 1. Language Learning Patterns

```{r language-patterns}
# Process language data
language_data <- questions %>%
  count(language) %>%
  arrange(desc(n))  # Sort data by count in descending order

# Create interactive bar chart
plot_ly(language_data,
        x = ~reorder(language, n),  # Reorder x-axis based on count
        y = ~n,
        type = "bar",
        marker = list(color = "#6a0dad")) %>%
  layout(
    title = list(
      text = "<span class='content-title'>Figure 1: Questions Generated by Language Category</span>",
      x = 0.5,
      y = 1,
      pad = list(t = 20, b = 0)
    ),
    xaxis = list(
      title = "Language", 
      tickangle = 45,
      categoryorder = "array",  # Use the explicit order we defined
      categoryarray = language_data$language  # Use our sorted order
    ),
    yaxis = list(title = "Number of Questions"),
    hovermode = "closest",
    margin = list(t = 40, r = 10, l = 10, b = 10)
  )
```

**Figure 1 Description**: This bar chart shows the distribution of questions generated across different language categories. Spanish leads in question generation, followed by GlizzyTalk and Tamil, indicating these are the most popular learning categories among users. The variation in question counts suggests different levels of engagement across language options, which could inform future content development priorities.

## 2. Temporal Usage Patterns

```{r activity-timeline}
# Process timeline data
timeline_data <- questions %>%
  mutate(created_at = as.POSIXct(created_at, format = "%Y-%m-%d %H:%M:%OS", tz = "UTC")) %>%
  mutate(date = as.Date(created_at)) %>%
  group_by(date) %>%
  summarise(number_of_questions = n())

# Create interactive time series
plot_ly(timeline_data,
        x = ~date,
        y = ~number_of_questions,
        type = "scatter",
        mode = "lines+markers",
        line = list(color = "#d5c5e8"),
        marker = list(color = "#6a0dad")) %>%
  layout(
    title = list(
      text = "<span class='content-title'>Figure 2: Daily Question Generation Activity</span>",
      x = 0.5,
      y = 1,
      pad = list(t = 20, b = 0)
    ),
    xaxis = list(title = "Date"),
    yaxis = list(title = "Number of Questions"),
    hovermode = "closest",
    margin = list(t = 40, r = 10, l = 10, b = 10)
  )
```

**Figure 2 Description**: The time series plot reveals the daily pattern of question generation over time. Notable spikes in activity occur periodically, particularly around December, 2024, suggesting possible promotional events or user engagement initiatives. The baseline activity shows consistent but relatively low engagement, indicating opportunities for improving regular user participation.

## 3. Website Usage Analysis

```{r website-usage, echo=FALSE}
website_data <- websites %>%
  count(website) %>%
  arrange(desc(n)) %>%
  top_n(10, n)

plot_ly(website_data, x = ~reorder(website, n), y = ~n, type = "bar",
        marker = list(color = "#6a0dad")) %>%
  layout(title = "Top 10 Blocked Websites",
         xaxis = list(title = "Website"),
         yaxis = list(title = "Number of Blocks"))
```

**Figure 3 Description**: Interactive bar chart of the top 10 blocked websites by users.

## 4. Sentiment Analysis by Language

```{r sentiment-bar, echo=FALSE}
library(syuzhet)
sentiment_scores <- get_sentiment(questions$original_sentence, method = "syuzhet")
sentiment_df <- questions
sentiment_df$score <- sentiment_scores
sentiment_df$bin <- cut(sentiment_df$score,
                        breaks = c(-Inf, -1, -0.5, 0, 0.5, 1, 2, Inf),
                        labels = c("Very Negative", "Negative", "Slightly Negative", "Neutral", "Slightly Positive", "Positive", "Very Positive"))
sentiment_summary <- sentiment_df %>%
  count(bin, language) %>%
  group_by(language) %>%
  mutate(perc = n / sum(n))

plot_ly(sentiment_summary, x = ~bin, y = ~n, color = ~language, type = "bar") %>%
  layout(barmode = "stack", title = "Sentiment Distribution by Language",
         xaxis = list(title = "Sentiment Category"),
         yaxis = list(title = "Number of Sentences"))
```

**Figure 4 Description**: Stacked bar chart showing sentiment distribution by language mode.

## 5. LDA Topic Modeling

```{r lda-topics, echo=FALSE}
# Assume top_terms_per_topic is available from your LDA analysis
if (exists("top_terms_per_topic")) {
  for (t in unique(top_terms_per_topic$topic)) {
    print(
      plot_ly(top_terms_per_topic %>% filter(topic == t),
              x = ~reorder(term, beta), y = ~beta, type = "bar",
              marker = list(color = "#6a0dad")) %>%
        layout(title = paste("Topic", t, "Top Terms"),
               xaxis = list(title = "Term"),
               yaxis = list(title = "Importance (beta)"))
    )
  }
}
```

**Figure 5 Description**: Interactive bar plots of top terms for each LDA topic.

## 6. Correlation Matrix of User Features

```{r correlation-heatmap, echo=FALSE}
cor_data <- enhanced_profiles[, c("daily_goal", "density", "highlightStyle", "blocked_sites", "levels_attempted", "generated_questions", "answered_questions")]
cor_data$highlightStyle <- as.numeric(as.factor(cor_data$highlightStyle))
cor_matrix <- cor(cor_data, use = "complete.obs")
plot_ly(z = cor_matrix, x = colnames(cor_matrix), y = colnames(cor_matrix), type = "heatmap",
        colors = colorRamp(c("#f2b277", "#6a0dad"))) %>%
  layout(title = "Correlation Matrix of User Features")
```

**Figure 6 Description**: Interactive heatmap of correlations between user features and engagement metrics.

## 7. K-means Clustering & PCA

```{r pca-plot, echo=FALSE}
# Assume pca_df is available with PC1, PC2, and user_group3 columns
tmp <- exists("pca_df") && all(c("PC1", "PC2", "user_group3") %in% colnames(pca_df))
if (tmp) {
  plot_ly(pca_df, x = ~PC1, y = ~PC2, color = ~user_group3, type = "scatter", mode = "markers",
          marker = list(size = 10)) %>%
    layout(title = "PCA of User Engagement by User Group",
           xaxis = list(title = "PC1"),
           yaxis = list(title = "PC2"))
}
```

**Figure 7 Description**: PCA scatter plot of user engagement colored by user group.

## 8. Ordinal Regression Results

```{r ord-table, echo=FALSE}
if (exists("ord_tidy")) {
  DT::datatable(ord_tidy, options = list(pageLength = 5, dom = 't'),
                caption = htmltools::HTML("<div style='text-align: center; color: black; font-size: 16px'>Table: Ordinal Regression Coefficients for User Group Score</div>"))
}
```

**Table 1 Description**: Interactive table of ordinal regression coefficients for user group score.

# Conclusions

A summary of the main findings and recommendations is provided below. For the full discussion, see the [Conclusions](conclusions.html) page.

- Most users engage minimally, but a small subset are highly active.
- Spanish is the most popular language mode; website blocking is used mainly for professional/educational sites.
- Sentiment and topic analysis show broad, neutral content selection.
- Achievable daily goals and highlight style preferences are associated with higher engagement.
- See the full [Conclusions](conclusions.html) for actionable recommendations and further discussion.
